<!DOCTYPE html>

<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
  <!--<![endif]-->

  <!-- Head BEGIN -->

  <head>
    <meta charset="utf-8">
    <title>Metronic Shop UI</title>

    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <meta content="Metronic Shop UI description" name="description">
    <meta content="Metronic Shop UI keywords" name="keywords">
    <meta content="keenthemes" name="author">

    <meta property="og:site_name" content="-CUSTOMER VALUE-">
    <meta property="og:title" content="-CUSTOMER VALUE-">
    <meta property="og:description" content="-CUSTOMER VALUE-">
    <meta property="og:type" content="website">
    <meta property="og:image" content="-CUSTOMER VALUE-"><!-- link to image for socio -->
    <meta property="og:url" content="-CUSTOMER VALUE-">

    <link rel="shortcut icon" href="favicon.ico">

    <!-- Fonts START -->
    <link
      href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700|PT+Sans+Narrow|Source+Sans+Pro:200,300,400,600,700,900&amp;subset=all"
      rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,900&amp;subset=all"
      rel="stylesheet" type="text/css">
    <!--- fonts for slider on the index page -->
    <!-- Fonts END -->

    <!-- Global styles START -->
    <link href="assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
    <!-- Global styles END -->

    <!-- Page level plugin styles START -->
    <link href="assets/pages/css/animate.css" rel="stylesheet">
    <link href="assets/plugins/fancybox/source/jquery.fancybox.css" rel="stylesheet">
    <link href="assets/plugins/owl.carousel/assets/owl.carousel.css" rel="stylesheet">
    <link href="assets/plugins/css/jquery-confirm.min.css" rel="stylesheet">
    <link href="assets/plugins/css/pnotify.css" rel="stylesheet">
    <!-- Page level plugin styles END -->

    <!-- Theme styles START -->
    <link href="assets/pages/css/components.css" rel="stylesheet">
    <link href="assets/pages/css/slider.css" rel="stylesheet">
    <link href="assets/corporate/css/style.css" rel="stylesheet">
    <link href="assets/pages/css/style-shop.css" rel="stylesheet" type="text/css">
    <link href="assets/corporate/css/style-responsive.css" rel="stylesheet">
    <link href="assets/corporate/css/themes/red.css" rel="stylesheet" id="style-color">
    <link href="assets/corporate/css/custom.css" rel="stylesheet">
    <!-- Theme styles END -->
  </head>
  <!-- Head END -->

  <!-- Body BEGIN -->

  <body class="ecommerce">

    <header class="header"></header>

    <div class="main">
      <div class="container">
        <!-- address -->
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#address-form">新增</button>
        <div id="address-table"></div>
        <!-- //address -->
      </div>
    </div>

    <div class="footer"></div>

    <!-- Modal -->
    <div class="modal fade" id="address-form" tabindex="-1" role="dialog" aria-labelledby="addressFormLabel">
      <div class="modal-dialog" role="document" style="width: 660px;">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="addressFormLabel">Modal title</h4>
          </div>
          <div class="modal-body" style="padding: 15px 30px;">
            <div class="fuzzy_query">
              <input id="keywords" type="text" class="form-control input__inner" placeholder="请输入关键词自动匹配地址(必选)" list="key_list">
              <button type="button" id="search_key" class="btn btn-primary" style="display: none;">search</button>
              <datalist id="key_list">
              </datalist>
            </div>
            <form class="form-horizontal" id="edit-address" style="margin-top: 20px;">
              <div class="form-group">
                <label for="fullName" class="col-sm-3 control-label">收货人姓名</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" id="fullName" name="fullName" placeholder="长度不超过25个字符">
                </div>
              </div>
              <div class="form-group">
                <label for="gender" class="col-sm-3 control-label">性别</label>
                <div class="col-sm-9">
                  <select class="form-control" id="gender" name="gender">
                    <option>未知</option>
                    <option>男</option>
                    <option>女</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label for="mobile" class="col-sm-3 control-label">联系电话</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" id="mobile" name="mobile" placeholder="请输入联系电话">
                </div>
              </div>
              <div class="form-group">
                <label for="addressName" class="col-sm-3 control-label">收货地址</label>
                <div class="col-sm-9">
                  <textarea class="form-control" rows="2" id="addressName" name="addressName" placeholder="请输入收货地址"></textarea>
                </div>
              </div>
              <div class="form-group">
                <label for="addressDetail" class="col-sm-3 control-label">详细地址</label>
                <div class="col-sm-9">
                  <textarea class="form-control" rows="2" id="addressDetail" name="addressDetail" placeholder="请输入详细地址"></textarea>
                </div>
              </div>
              <div class="form-group">
                <label for="gender" class="col-sm-3 control-label">所在城市</label>
                <div class="col-sm-9">
                  <div data-toggle="distpicker" id="distpicker">
                    <div class="col-sm-4">
                      <label class="sr-only" for="province">Province</label>
                      <select class="form-control" id="province" ></select>
                    </div>
                    <div class="col-sm-4">
                      <label class="sr-only" for="city">City</label>
                      <select class="form-control" id="city" ></select>
                    </div>
                    <div class="col-sm-4">
                      <label class="sr-only" for="district">District</label>
                      <select class="form-control" id="district" ></select>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <div class="col-sm-offset-3 col-sm-9">
                  <div class="checkbox">
                    <label>
                      <input type="checkbox" id="isDefault" name="isDefault"> 设置为默认收货地址
                    </label>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-primary" id="address-save" onclick="handleCreate(this)">保存</button>
          </div>

        </div>
      </div>
    </div>


    <!-- Load javascripts at bottom, this will reduce page load time -->
    <!-- BEGIN CORE PLUGINS (REQUIRED FOR ALL PAGES) -->
    <!--[if lt IE 9]>
    <script src="assets/plugins/respond.min.js"></script>
    <![endif]-->
    <script src="assets/plugins/jquery.min.js" type="text/javascript"></script>
    <script src="assets/plugins/jquery-migrate.min.js" type="text/javascript"></script>
    <script src="assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="assets/plugins/bootstrap-table/bootstrap-table.min.js" type="text/javascript"></script>
    <script src="assets/corporate/scripts/back-to-top.js" type="text/javascript"></script>
    <script src="assets/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
    <script src="assets/plugins/jquery.cokie.min.js"></script>
    <script src="assets/plugins/js/jquery-confirm.min.js" type="text/javascript"></script>
    <script src="assets/plugins/js/pnotify.js" type="text/javascript"></script>
    <script src="assets/plugins/js/template-web.js" type="text/javascript"></script>
    <script src="assets/plugins/distpicker/distpicker.data.min.js" type="text/javascript"></script>
    <script src="assets/plugins/distpicker/distpicker.min.js" type="text/javascript"></script>
    <script src="assets/plugins/jquery.validate.min.js" type="text/javascript"></script>
    <script src="assets/plugins/jquery.validate.extend.js" type="text/javascript"></script>
    <!-- END CORE PLUGINS -->

    <!-- BEGIN PAGE LEVEL JAVASCRIPTS (REQUIRED ONLY FOR CURRENT PAGE) -->
    <script src="assets/plugins/fancybox/source/jquery.fancybox.pack.js" type="text/javascript"></script><!-- pop up -->
    <script src="assets/plugins/owl.carousel/owl.carousel.min.js" type="text/javascript"></script>
    <!-- slider for products -->
    <script src='assets/plugins/zoom/jquery.zoom.min.js' type="text/javascript"></script><!-- product zoom -->
    <script src="assets/plugins/bootstrap-touchspin/bootstrap.touchspin.js" type="text/javascript"></script>
    <!-- Quantity -->
    <script src="assets/corporate/scripts/utils.js"></script>
    <script src="assets/corporate/scripts/request.js"></script>
    <script src="assets/corporate/scripts/layout.js" type="text/javascript"></script>
    <script src="assets/pages/scripts/bs-carousel.js" type="text/javascript"></script>
    <script type="text/javascript">
      jQuery(document).ready(function () {
        Layout.init();
        Layout.initOWL();
        Layout.initImageZoom();
        Layout.initTouchspin();
        // Layout.initTwitter();
      });
    </script>
    <script>
      $('.header').load('./header.html', function (responseTxt, statusTxt, xhr) { })
      $('.footer').load('./footer.html', function (responseTxt, statusTxt, xhr) { })
    </script>
    <script src="./assets/pages/scripts/address.js"></script>
    <script>
      $('#distpicker').distpicker({
        province: '福建省',
        city: '厦门市',
        district: '思明区'
      });
      $('#address-form').modal()
      //点击事件
      $('#search_key').on('click', function () {
        var keyWord = $('#keywords').val();
        console.log(keyWord);
        renderFruits(keyWord);
      }, false);
      // //回车查询
      // $("#txt").keydown(function (e) {
      //     if (e.keyCode == 13) {
      //         var keyWord = $('#keywords').val();
      //         console.log('huiche')
      //         // var fruitList = searchByIndexOf(keyWord,fruits);
      //         var fruitList = searchByRegExp(keyWord, fruits);
      //         renderFruits(fruitList);
      //     }
      // }, false);
      var cpLock = false;
      $('#keywords').on('compositionstart', function () {
        cpLock = true;
        console.log("不搜索")
      });
      $('#keywords').on('compositionend', function () {
        cpLock = false;
        console.log("汉字搜索");
        var keyWord = $('#keywords').val();
        renderFruits(keyWord);
      });
      $('#keywords').on('input', function () {
        if (!cpLock) {
          console.log("字母搜索")
          var keyWord = $('#keywords').val();

          var $options = $("#key_list").children();
          for (var i = 0; i < $options.length; i++) {
            if ($options.eq(i).val().trim() == $("#keywords").val().trim()) {
              let data = JSON.parse($options.eq(i).attr("data"))
              console.log(data)
              $('#distpicker').distpicker('destroy');
              $('#distpicker').distpicker({
                province: data.province,
                city: data.city,
                district: data.district
              });
              $('#addressName').val(data.name)
              $('#addressDetail').val(data.address)
              $('#address-save').attr('location', data.location)
              break;
            }
          }

          renderFruits(keyWord);
        }
      });
      function renderFruits(keyWord) {
        if (keyWord) {
          // var params = {
          //   keywords: keyWord
          // }
          ajaxPromise({ url: `${baseUrl}/common/map/search`, data: { keywords: keyWord } }).then(res => {
            // 将数据渲染到页面
            let list = res.data;
            if (!(list instanceof Array)) {
              return;
            }
            $('#key_list').innerHTML = '';
            var len = list.length;
            let keyList = ''
            for (var i = 0; i < len; i++) {
              var item = JSON.stringify(list[i])
              keyList += `<option data=${item} value=${list[i].name}/>`
            }
            $('#key_list').html(keyList);
          })

        }
      }
      renderFruits();
    </script>
    <!-- END PAGE LEVEL JAVASCRIPTS -->
  </body>
  <!-- END BODY -->

</html>